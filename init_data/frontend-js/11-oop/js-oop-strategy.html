<h1>ООП патерны в javascript.</h1>

<h2>Паттерн Стратегия.</h2>

<p>Предположим создаем приложении "Зоопарк".</p>

<p>В котором мы имеем следующую иерархию классов.</p>

<p>Класс Животное.</p>

<p>Класс Кот</p>

<p>Класс Собака</p>

<p>Классы Кот и Собака являются наследниками  класса животного.</p>

<p>Прямое использование классов в js (ES6) не будет поддерживаться  старыми браузерами</p>

<pre><code>SyntaxError: Unexpected token class(…)
</code></pre>

<p>И для этого необходимо использовать транспиляторы типа babel webpack и пр. или полифилы.</p>

<p>Однако использование конструкции class является вовсе не обязательным в js и все можно реализовать исключительно в функциональном стиле.</p>

<p>При помощи объектов и функций в яваскрипт мы можем реализовать любой каприз ООП.</p>

<p>Составим данную программу и отобразим животных на странице.</p>

<p>Как создать "типа-класс" в js?</p>

<pre><code>var Animal = function() {}
</code></pre>

<p>или так</p>

<pre><code>function Animal() {}
</code></pre>

<p>При этом фокус в том, что мы полагаем, что эту функцию будут вызывать с ключевым словом new.</p>

<p>Поэтому такие функции называют функции-конструкторы и названия пишут (для удобства) с большой прописной буквы.</p>

<p>Шаблон.</p>

<pre><code>&lt;!doctype html&gt;
&lt;html lang="en"&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;style&gt;
    &lt;/style&gt;
    &lt;title&gt;Zoo&lt;/title&gt;
  &lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Zoo&lt;/h1&gt;
    &lt;div id="root"&gt; &lt;/div&gt;
    &lt;script src="jquery.min.js" &gt;&lt;/script&gt;
    &lt;script src="app.js" &gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>

<h2>Создадим класс (функцию-конструктор) животного.</h2>

<p>Данные.</p>

<ul>
<li>размер (пиксели)</li>
</ul>

<p>Функции.</p>

<ul>
<li><p>отображение</p></li>
<li><p>перемещение</p>

<p>var Animal = function(){
};</p>

<p>Animal.prototype.move = function() {
    console.log('I am mooving')
};
Animal.prototype.size = 100
Animal.prototype.show = function() {
    $("#root").append(<code>&lt;img src="${this.image}" width="${this.size}" /&gt;</code>);
};</p></li>
</ul>

<h2>Собаки и коты.</h2>

<p>Данные.</p>

<ul>
<li><p>картинка</p></li>
<li><p>имя</p></li>
</ul>

<p>Функции.</p>

<ul>
<li><p>голос</p>

<p>var Dog = function(name,image) {
    this.name = name;
    this.image = image;
    this.voice = function() {
        console.log(<code>gav gav my name is ${this.name} ${this.size}</code>);
    }
}</p>

<p>Dog.prototype = Animal.prototype;</p></li>
</ul>

<p>Клиентский код</p>

<pre><code>var d = new Dog('Bobik','bobik.png');
d.voice();
d.show();
</code></pre>

<h2>ES6</h2>

<pre><code>class Animal {
    size = 50;
    show() {
        $("#root").append(`&lt;img src="${this.image}" width="${this.size}" /&gt;`);
    };
    move() {
        console.log('I am mooving');
    };
}


class Dog extends Animal {

    constructor(name,image) {
        super();
        this.name = name;
        this.image = image;
    }

    voice() {
        console.log(`gav gav my name is ${this.name} ${this.size}`);
    }
}


var d = new Dog('Bobik','bobik.png');
d.show();
</code></pre>

<p>Добавим кнопки и оформим все на странице.</p>

<pre><code>class Animal {
    size = 150;

    show() {
        const tpl = `
        &lt;div&gt;
             &lt;img src="${this.image}" width="${this.size}" /&gt;
             &lt;p&gt;
                &lt;button id="v-button-${this.name}"&gt;Voice&lt;/button&gt;
                &lt;button id="m-button-${this.name}"&gt;Move&lt;/button&gt;
             &lt;/p&gt;
        &lt;/div&gt;
        `
        $("#root").append(tpl);
        $('#m-button-'+this.name).on('click',this.move);
        $('#v-button-'+this.name).on('click',()=&gt; {this.voice()});
    };
    move() {
        console.log('I am mooving');
    };
}


class Dog extends Animal {

    constructor(name,image) {
        super();
        this.name = name;
        this.image = image;
    }

    voice() {
        console.log(`gav gav my name is ${this.name}`);
    }
}


var d = new Dog('Bobik','bobik.png');
d.show();
</code></pre>

<p><strong><button id="v-button-${this.name}">Voice</button></strong> - мы присваиваем уникальный идентификатор кнопкам для подвязки колбеков. Пока полагаем, что имя зверей будет уникальным.</p>

<p><strong>$(...).on('click',()=&gt; {this.voice()})</strong> - тут мы обвязали колбек стрелочной функцией чтобы не потерять контекст this т.к. если этого не сделать, в нем окажется элемент кнопки и мы не сможем обратиться к this.name внутри метода voice.</p>

<p>Создаем класс для котов.</p>

<pre><code>class Cat extends Animal {

    constructor(name,image) {
        super();
        this.name = name;
        this.image = image;
    }

    voice() {
        console.log(this);
        console.log(`miau miau my name is ${this.name}`);
    }
}
</code></pre>

<p>Используем классы в клиентском коде.</p>

<pre><code>var dogObj = new Dog('Bobik','bobik.png');
dogObj.show();

var catObj = new Cat('Murka','murka.png');
catObj.show();
</code></pre>

<p>Результат.</p>

<p><img src="https://webmonstr.com/media/course/frontend-js/11-oop/images/2.png" alt="start page" /></p>

<h2>Новая задача от заказчика.</h2>

<p>Необходимо добавить новую функцию прыжка для всех зверей.</p>

<h3>Решение "В лоб".</h3>

<p>Добавляем метод в базовый класс Animal.</p>
