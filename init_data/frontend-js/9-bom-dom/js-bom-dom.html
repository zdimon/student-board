<h1>Объектная модель браузера и документа.</h1>

<h2>Объектная модель браузера</h2>

<p>Поскольку коды JavaScript обрабатываются и выполняются браузером, они не могут
прямо управлять самим браузером, лишь в той степени, в которой браузер это позволяет.</p>

<p>Основные ограничения.</p>

<p>При помощи JavaScript нельзя запускать другие приложения, давать команды операционной системе.</p>

<p>Инструкции JavaScript не имеют прямого доступа к файлам компьютера.</p>

<p>Из скриптов одной вкладки нельзя управлять содержимым других вкладок.</p>

<p>Обращаться к серверу при помощи JavaScript можно
только в том случае, если сайт был загружен именно с этого сервера.</p>

<p>Командами JavaScript нельзя закрыть или запустить
браузер, свернуть его главное окно или изменить
его размеры.</p>

<p>Взаимодействие с браузером и системой всё же необходимо для хорошо построенных сайтов. Например, могут возникнуть задачи вернуться на предыдущую просмотренную страницу, открыть новую страницу (или новый
сайт) в текущей или новой вкладке браузера, а также получить данные о типе браузера или операционной системе, в которой он запущен.</p>

<p>Возможности, которые предоставляет браузер для
использования кодами JavaScript, составляют основу Брау­зерной Объектной Модели</p>

<p>Согласно с этой моделью, работа с браузером и, через него,
с операционной системой заменяется работой со специальным объектом «window»</p>

<p>Из этого объекта можно получить
(считать) информацию о параметрах и свойствах браузера,
системы или устройства, а также установить или изменить
(записать) некоторые величины, влияющие на их работу.</p>

<h2>Структура объекта windows.</h2>

<p><img src="https://webmonstr.com/media/course/frontend-js/9-bom-dom/images/1.png" alt="start page" /></p>

<p>Группу ресурсов (Resources) формируют объекты
и функции, обеспечивающие вспомогательные задачи, такие как:</p>

<ul>
<li><p>таймер и отложенный запуск функций (Timing);</p></li>
<li><p>диалоговые окна (Popup), (alert, prompt, confirm);</p></li>
<li><p>асинхронный обмен данными через объект «XML­Http­Request».</p></li>
</ul>

<p>Объект «document» является основой объектной модели документа (Document Object Model, DOM).</p>

<p>В нем собирается информация о структуре HTML страницы.</p>

<h2>Объект window.</h2>

<p>Этот объект «представляет» окно браузера как главный контейнер для веб-страницы.</p>

<p>Всё,
что присутствует на этой веб-странице, так или иначе,
попадает в объект «window» и становится доступным
для программного управления.</p>

<p>Кроме HTML элементов
страницы в объекте «window» также собираются все переменные и функции, объявленные в различных скриптах страницы.</p>

<p>Основные свойства объекта «window» определяют размеры и положение текущего окна (вкладки) браузера.</p>

<p><strong>innerHeight</strong> - Высота контента окна (без панелей браузера)</p>

<p><strong>innerWidth</strong> - Ширина контента окна</p>

<p><strong>outerHeight</strong> - Высота окна браузера (включая панели)</p>

<p><strong>outerWidth</strong> - Ширина окна браузера</p>

<p><strong>screenLeft, screenX</strong> - Отступ от левого края окна браузера до начала
содержимого страницы (контента)</p>

<p><strong>screenTop, screenY</strong> - Отступ от верхнего края окна браузера до начала
содержимого страницы (контента)</p>

<p><strong>scrollX, scrollY</strong> - Величина (в пикселях) сдвига контента за счет
полос прокрутки</p>

<p>Все эти свойства доступны только для чтения.</p>

<p>Основные методы объекта «window», позволяющие
управлять самими окнами.</p>

<p><strong>open()</strong> - Открывает новое пустое окно браузера</p>

<p><strong>open(addr,id,attr)</strong> - Открывает новое окно и загружает страницу с адресом addr. Окну присваивается имя «id» и применяются атрибуты «attr»</p>

<p><strong>stop()</strong> - Прекращает загрузку окна</p>

<p><strong>close()</strong> - Закрывает окно</p>

<p><strong>moveTo(X,Y)</strong> - Перемещает окно в точку экрана с заданными координатами</p>

<p><strong>moveBy(dX,dY)</strong> - Сдвигает позицию окна по каждой координате</p>

<p><strong>resizeTo(W,H)</strong> - Устанавливает размеры окна на заданные</p>

<p><strong>resizeBy(dW,dH)</strong> - Прибавляет к размерам окна переданные значения</p>

<p>Открыть вкладку.</p>

<pre><code>window.open();
</code></pre>

<p>Для того чтобы открыть окно передаем атрибута «resizable».</p>

<pre><code>newWin=window.open("https://itstep.org", "StepWin", "resizable");
</code></pre>

<p>Закрываем.</p>

<pre><code>newWin.close()
</code></pre>

<h2>Объект Navigator.</h2>

<p>Объект «navigator» используется для сбора информации от операционной системы, параметрах, настройках и состоянии браузера.</p>

<p>Информацию, содержащуюся в объекте «navigator»,
не следует использовать как однозначно достоверную.</p>

<p>Из полезных свойств.</p>

<p>getUser­Media() - Доступ к медиаресурсам</p>

<p>Пример захвата камеры.</p>

<pre><code>&lt;video autoplay="true" id="videoElement"&gt;&lt;/video&gt;

&lt;script&gt;

var video = document.querySelector("#videoElement");

if (navigator.mediaDevices.getUserMedia) {
  navigator.mediaDevices.getUserMedia({ video: true })
    .then(function (stream) {
      video.srcObject = stream;
    })
    .catch(function (err0r) {
      console.log("Something went wrong!");
    });
}

&lt;/script&gt;
</code></pre>

<p><img src="https://webmonstr.com/media/course/frontend-js/9-bom-dom/images/4.png" alt="start page" /></p>

<p>Некоторые свойства объекта «navigator» рассчитаны на использовании в составе мобильных устройств. Например, свойство «battery» или метод «getBattery()»</p>

<p>Свойство «connection» может быть использовано для
получения информации о типе сетевого подключения.</p>

<p><img src="https://webmonstr.com/media/course/frontend-js/9-bom-dom/images/2.png" alt="start page" /></p>

<h2>Объект Screen. Свойства экрана</h2>

<p>Информация, содержащаяся в объекте «window.screen»,
определяет параметры экрана монитора, такие как глубина
цвета и ориентация, а также его размеры в пикселях.</p>

<p>Наиболее достоверными и часто применимыми свойствами объекта «screen» являются те, которые отвечают за размеры экрана монитора. Среди них можно выделить
две группы свойств: «width» и «height» — определяющие
полные размеры экрана (ширину и высоту, соответственно), а также «availWidth» и «availHeight» — отвечающие за доступные (от англ. available) размеры, то есть
за свободную часть окна, без учета панели задач, строк
состояния, док-панелей и т.п.</p>

<h2>Объекты Location и History. Перемещение по страницам</h2>

<p>Объекты «location» и «history» в структуре ВОМ обеспечивают управление адресами веб-страниц, которые отображаются на данной вкладке браузера. При помощи этих объектов можно перемещаться по различным страницам.</p>

<p>Объект «location» собирает в себе данные об вебадресе текущей страницы, открытой в данный момент в данной вкладке. С его помощью можно узнать об этом
адресе и его составных частях, а также загрузить в текущей вкладке страницу с другим адресом.</p>

<p>Структура адреса.</p>

<pre><code>https://www.google.com/search?q=itstep&amp;oq=itstep#anchor

протокол+домен+uri+параметры#якорь
</code></pre>

<p>У объекта «location» существует несколько методов,
предназначенных для управления адресом отображаемой
страницы.</p>

<p><strong>assign(addr)</strong> - Перейти по адресу addr.</p>

<p><strong>reload()</strong> - Обновить (перезагрузить) страницу </p>

<p><strong>reload(true)</strong> – перезагрузить с сервера</p>

<p><strong>reload(false)</strong> или reload() – из кеша браузера</p>

<p><strong>replace(addr)</strong> Сменить адрес на addr</p>

<p>При replase история не хранится.</p>

<p>Объект «location» предусматривает возможность сокращенной формы вызова метода «assign» при помощи оператора присваивания:</p>

<pre><code>window.location = "https://itstep.org"
</code></pre>

<p>Изменить протокол.</p>

<pre><code>window.location.protocol = "https:"
</code></pre>

<p>Происходит перезагрузка страницы.</p>

<h2>History.</h2>

<p>Методы.</p>

<p>length - Количество страниц в истории текущей вкладки </p>

<p>back() - Переход к предыдущей странице в истории просмотров Аналогичен go(-1)</p>

<p>forward() Переход к следующей странице в истории просмотров Аналогичен go(1)</p>

<p>go(n) - Переместиться на n шагов в истории просмотров n>0 — вперед по истории n&lt;0 — назад по истории</p>

<p>pushState(state, title, addr) - Добавить запись в историю После добавления происходит переход на добавленную страницу</p>

<p>replaceState(state, title, addr) - Заменить запись в истории</p>

<h2>Фреймы.</h2>

<p>Фреймы являются «окнами в окне» — для них, так же
как и для основной страницы, создается объект «window»
со всеми свойствами и методами, со своей моделью ВОМ.</p>

<pre><code>&lt;iframe src='https://itstep.org'&gt;&lt;/iframe&gt;.
</code></pre>

<p>Все фреймы страницы хранятся в специальном объекте-коллекции «window.frames».</p>

<p>Задание имени фрейма.</p>

<pre><code>&lt;iframe name='itstepFrame' src='https://itstep.org'&gt;&lt;/iframe&gt;

window.frames.itstepFrame
</code></pre>

<p>Установка локации.</p>

<pre><code>window.frames[0].location='https://itstep.org'
</code></pre>

<h2>Объектная модель документа.</h2>

<p>Для введения общих правил обработки HTML кода и построения из него страницы, World
Wide Web Consortium (W3C) подготовил и опубликовал
требования, известные нам под названием «объектная
модель документа» (Document Object Model, DOM).</p>

<p>Что же такое DOM? Это набор требований к тому, как
веб-страница должна быть представлена в виде управляемой информационной системы, каким образом элементы
HTML должны превратиться в программные элементы
(элементы DOM), при помощи каких команд ими можно
управлять, на какие события они должны реагировать
и так далее.</p>

<p>ВОМ - является программным «представителем» браузера, включая операционную систему, в которой он работает. В свою очередь, модель документа (DOM) «представляет» саму
веб-страницу, открытую в браузере.</p>

<p>Одна страница в разных ОС будет иметь разный BOM.</p>

<p>Задачи DOM практически никак не касаются самого браузера и нацелены на построение содержимого
веб-страницы.</p>

<p>Основным элементом модели является узел (node).
Дочерние узлы хранятся в его коллекции «childNodes»,
родительский узел доступен через свойство «parentNode».</p>

<p>Основные теги документа.</p>

<pre><code>document.documentElement.childNodes
</code></pre>

<h3>Иерархия элементов.</h3>

<p><img src="https://webmonstr.com/media/course/frontend-js/9-bom-dom/images/3.png" alt="start page" /></p>

<h2>Изменение DOM.</h2>

<h3>Создание элементов.</h3>

<pre><code>document.createElement(tagName)

document.createElement('div')
</code></pre>

<h3>Установка атрибутов.</h3>

<pre><code>clickedElement.style.opacity = '0.5';
</code></pre>

<h3>Добавление элементов.</h3>

<p>removeChild(е) — удаляет дочерний узел «е», пере-
данный как аргумент функции;</p>

<p>appendChild(е) — добавляет дочерний узел «е» в ко-
нец существующей коллекции дочерних узлов;</p>

<p>insertBefore(е1, е2) — вставляет узел «е1» в коллекцию дочерних элементов перед узлом «е2».</p>

<p>Эти функции присутствуют в каждом узле дерева
DOM и позволяют оперировать с собственной коллекцией дочерних элементов.</p>

<h3>Поиск элементов.</h3>

<p>Методы поиска элементов - getElementById, getElementsByName, getElements­By­ClassName и getElementsByTagName.</p>

<p>getElementById  может быть вызван только
у объекта «document», а остальные методы могут вызываться в любом узле дерева элементов DOM.</p>

<p>Наиболее широкие возможности поиска элементов
обеспечивает метод «querySelectorAll».</p>

<p>Формат вызова.</p>

<pre><code>document.querySelectorAll("LI")
</code></pre>

<p><a href="https://www.w3schools.com/cssref/css_selectors.asp">ссылка на описание селекторов</a></p>
